 Homework 2.
Задача 1
Table: Transactions
Client_id	Report_date	Txn_amount
123	2017.01.01	50000

Table: Rates
Report_date	Ccy_code	CCy_rate
2016.12.30	840	60,58
2017.01.09	840	61,01

Задание: Напишите sql запрос, который будет переводить сумму транзакций в usd (ccy_code = 840) с учетом того, что в таблице rates данные только за рабочие дни. Транзакции, совершенные в выходные, пересчитываются по курсу последнего рабочего дня перед праздником/выходным. Результат: Клиент, дата, сумма операций в usd.

Задача 2
Table: VSP_oper_data
Client_id	Report_date	VSP_Number	Txn_type	Txn_amount
1233455	2017.05.02	1234/0123	deposit	10000

В таблице VSP_oper_data txn_type принимает значения debit, credit
Задание: напишите sql запрос, который для каждого клиента выводит сумму debit, credit операций и последнее посещенное VSP по месяцам. Результат представьте в виде: 
Client_id	Report_date	Debit_amount	Credit_amount	Last_VSP
				
	







Homework 3.

Есть таблица Ctr_Oper следующей структуры:			
				
Поле	Тип	Описание
idOper	number	Идентификатор операции
idContract	number	Идентификатор договора
dOper	date	Дата операции (с точн до дня)
Sum_RUB	number	Сумма операции	

Значения idOper уникальны (первичный ключ), остальные поля - не уникальны.
Например, в одну дату один договор может иметь несколько операций.

Задача 1.
Написать запрос, который для каждой записи таблицы выведет все исходные 
поля плюс долю в % суммы каждой операции от общей суммы операций по договору.

Задача 2.
Написать запрос, который выведет поля: Месяц совершения операции, число
договоров, совершивших в указанном месяце более 2-х операций.

Задача 3.
Для каждого договора вычислить дату его самой первой операции и вывести в виде:
Договор, Дата первой операции, Сумма первой операции

Задача 4.
Для каждой записи вывести дополнительное поле "Сумма операций по договору
 нарастающим итогом (в порядке возрастания даты операции)"
Homework 4.

Дана модель фрагмента БД Библиотека:
Книги:
- ID книги
- Название 
- Автор 
- Издательство
- Год издания
- Город издания
- Количество страниц

Экземпляры книг:
- ID экземпляра
- ID книги

Выдачи книг:
- ID экземпляра
- Дата выдачи
- Дата возврата
- № читательского билета

Читатели:
- № читательского билета
- Фамилия
- Имя 
- Отчество 
- Дата рождения
- Пол
- Адрес
- Телефон
Задание 1:
 Найти города, в которых в 2016 году было издано больше всего книг.
Задание 2:
Вывести количество экземпляров книг «Война и мир» Л.Н.Толстого, которые находятся в библиотеке (не на руках у читателей).
Задание 3:
 Найти читателя, который за последний месяц брал больше всего книг в библиотеке. 
Если читателей с максимальным количество несколько - вывести только тех, у кого самый маленький возраст.

Задание 4:
Доработать ЛМД таким образом, чтобы можно было хранить данные о сотрудниках библиотеки, которые выдали книгу читателю.
Нарисовать ER-диаграмму получившейся ЛМД.
